require_relative_test_helper

class_PillboxTest__MinitestTest
__def_setup
____super
____user__Usercreate
______name_Test_User
______email_testexamplecom
______password_password123
______password_confirmation_password123
____
__end
__
__def_test_should_create_daily_pillbox
____pillbox__userpillboxescreate
______name_Morning_Meds
______pillbox_type_daily
____
____
____assert_pillboxpersisted
____assert_equal_Morning_Meds_pillboxname
____assert_equal_daily_pillboxpillbox_type
____assert_pillboxdaily
____refute_pillboxweekly
__end
__
__def_test_should_create_weekly_pillbox_with_autogenerated_compartments
____pillbox__userpillboxescreate
______name_Weekly_Organizer
______pillbox_type_weekly
____
____
____assert_equal_7_pillboxcompartmentscount
____
____days__pillboxcompartmentsby_positionmapday_of_week
____assert_equal_monday_tuesday_wednesday_thursday_friday_saturday_sunday_days
__end
__
__def_test_should_validate_name_presence
____pillbox__userpillboxesbuild
______pillbox_type_daily
____
____
____refute_pillboxvalid
____assert_includes_pillboxerrorsname_cant_be_blank
__end
__
__def_test_should_validate_name_length
____pillbox__userpillboxesbuild
______name_a__16__Exceeds_15_character_limit
______pillbox_type_daily
____
____
____refute_pillboxvalid
____assert_includes_pillboxerrorsname_is_too_long_maximum_is_15_characters
__end
__
__def_test_should_validate_pillbox_type_presence
____pillbox__userpillboxesbuild
______name_Test_Box
____
____
____refute_pillboxvalid
____assert_includes_pillboxerrorspillbox_type_cant_be_blank
__end
__
__def_test_should_validate_pillbox_type_inclusion
____assert_raises_ArgumentError_do
______userpillboxescreate
________name_Test_Box
________pillbox_type_invalid_type
______
____end
__end
__
__def_test_should_track_last_filled_at_timestamp
____pillbox__userpillboxescreate
______name_Test_Box
______pillbox_type_daily
____
____
____assert_nil_pillboxlast_filled_at
____
____pillboxupdatelast_filled_at_Timecurrent
____
____assert_not_nil_pillboxlast_filled_at
____assert_equal_0_pillboxdays_since_filled
__end
__
__def_test_should_calculate_days_since_filled
____pillbox__userpillboxescreate
______name_Test_Box
______pillbox_type_daily
______last_filled_at_3daysago
____
____
____assert_equal_3_pillboxdays_since_filled
__end
__
__def_test_should_determine_needs_refill
____pillbox__userpillboxescreate
______name_Test_Box
______pillbox_type_weekly
____
____
_____Never_filled
____assert_pillboxneeds_refill
____
_____Filled_recently_within_7_days_for_weekly
____pillboxupdatelast_filled_at_3daysago
____refute_pillboxneeds_refill
____
_____Filled_8_days_ago_needs_refill
____pillboxupdatelast_filled_at_8daysago
____assert_pillboxneeds_refill
__end
__
__def_test_daily_pillbox_needs_refill_threshold_is_1_day
____pillbox__userpillboxescreate
______name_Daily_Box
______pillbox_type_daily
____
____
_____Same_day__no_refill_needed
____pillboxupdatelast_filled_at_Timecurrent
____refute_pillboxneeds_refill
____
_____2_days_ago__needs_refill
____pillboxupdatelast_filled_at_2daysago
____assert_pillboxneeds_refill
__end
__
__def_test_should_belong_to_user
____pillbox__userpillboxescreate
______name_Test_Box
______pillbox_type_daily
____
____
____assert_equal_user_pillboxuser
__end
__
__def_test_should_have_many_compartments
____pillbox__userpillboxescreate
______name_Test_Box
______pillbox_type_daily
____
____
____pillboxadd_compartmentname_Morning
____pillboxadd_compartmentname_Evening
____
____assert_equal_2_pillboxcompartmentscount
__end
__
__def_test_should_destroy_associated_compartments_when_destroyed
____pillbox__userpillboxescreate
______name_Test_Box
______pillbox_type_daily
____
____
____pillboxadd_compartmentname_Morning
____comp_id__pillboxcompartmentsfirstid
____
____pillboxdestroy
____
____assert_nil_Compartmentfind_byid_comp_id
__end
__
__def_test_should_add_compartments_to_daily_pillbox
____pillbox__userpillboxescreate
______name_Daily_Box
______pillbox_type_daily
____
____
____comp__pillboxadd_compartmentname_Morning_time_of_day_morning
____
____assert_equal_Morning_compname
____assert_equal_morning_comptime_of_day
____assert_equal_1_compposition
__end
__
__def_test_should_enforce_max_compartments_for_daily_pillbox
____pillbox__userpillboxescreate
______name_Daily_Box
______pillbox_type_daily
____
____
_____Add_maximum_allowed_12
____12times_do_i
______pillboxadd_compartmentname_Compartment_i__1
____end
____
____assert_equal_12_pillboxcompartmentscount
____
_____Try_to_add_one_more
____assert_raises_RuntimeError_do
______pillboxadd_compartmentname_Extra
____end
__end
end
