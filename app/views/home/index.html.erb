<!DOCTYPE html>
<html>
<head>
    <title>ðŸ’Š Pill Boxer</title>
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, sans-serif; 
            margin: 0; 
            padding: 20px; 
            background: #f8fafc; 
            color: #374151;
        }
        .container { max-width: 800px; margin: 0 auto; }
        .welcome { text-align: center; margin-bottom: 2rem; }
        .welcome h1 { color: #1f2937; font-size: 2rem; margin-bottom: 0.5rem; }
        .subtitle { color: #6b7280; font-size: 1.1rem; }
        .section { background: white; padding: 1.5rem; margin: 1rem 0; border-radius: 8px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); }
        .time-period { margin: 1rem 0; }
        .time-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 1rem; }
        .time-header h3 { margin: 0; color: #1f2937; }
        .pill-count { background: #3b82f6; color: white; padding: 0.25rem 0.75rem; border-radius: 1rem; font-size: 0.875rem; }
        .medication-item { padding: 1rem; border: 1px solid #e5e7eb; border-radius: 6px; margin: 0.5rem 0; }
        .med-name { font-weight: 500; color: #1f2937; }
        .med-details { color: #6b7280; font-size: 0.875rem; margin-top: 0.25rem; }
        .stats { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; }
        .stat-card { text-align: center; padding: 1rem; }
        .stat-number { font-size: 1.5rem; font-weight: 700; color: #3b82f6; }
        .stat-label { color: #6b7280; font-size: 0.875rem; }
        .no-meds { color: #6b7280; font-style: italic; }
    </style>
</head>
<body>
    <div class="container">
        <div class="welcome">
            <h1>ðŸ’Š Pill Boxer</h1>
            <p class="subtitle">Your personal medication management assistant</p>
        </div>

        <div class="section">
            <h2>Today's Medications</h2>
            
            <% @todays_medications.each do |time_period| %>
                <div class="time-period">
                    <div class="time-header">
                        <h3><%= time_period[:time].capitalize %></h3>
                        <span class="pill-count"><%= time_period[:count] %> pills</span>
                    </div>
                    
                    <% if time_period[:medications].any? %>
                        <% time_period[:medications].each do |schedule_medication| %>
                <div class="medication-info">
                  <span class="name"><%= schedule_medication.medication.name %></span>
                  <span class="dosage"><%= schedule_medication.medication.dosage %></span>
                  <span class="quantity">Ã— <%= schedule_medication.quantity %></span>
                </div>
                
                <%= button_to toggle_taken_medication_path(schedule_medication.medication), 
                    method: :patch,
                    remote: true,
                    class: "take-button",
                    data: { 
                      turbo_method: :patch,
                      controller: "medication-toggle" 
                    } do %>
                  âœ“ Mark Taken
                <% end %>
              </div>
            <% end %>
          <% else %>
            <p class="no-medications">No medications scheduled for this time</p>
          <% end %>
        </div>
      </div>
    <% end %>
  </div>

  <div class="quick-actions">
    <h2>Quick Actions</h2>
    <div class="action-buttons">
      <%= link_to new_medication_path, class: "btn btn-primary" do %>
        <span class="icon">âž•</span>
        Add Medication
      <% end %>
      
      <%= link_to medications_path, class: "btn btn-secondary" do %>
        <span class="icon">ðŸ’Š</span>
        View All Medications
      <% end %>
      
      <%= link_to schedules_path, class: "btn btn-secondary" do %>
        <span class="icon">ðŸ“‹</span>
        Manage Schedules
      <% end %>
    </div>
  </div>

  <div class="stats-section">
    <h2>Today's Progress</h2>
    <div class="stats-grid">
      <div class="stat-card">
        <div class="stat-number"><%= @today_logs.taken.count %></div>
        <div class="stat-label">Taken</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-number"><%= @today_logs.missed.count %></div>
        <div class="stat-label">Missed</div>
      </div>
      
      <div class="stat-card">
        <div class="stat-number"><%= @medications.count %></div>
        <div class="stat-label">Active Medications</div>
      </div>
    </div>
  </div>
</div>